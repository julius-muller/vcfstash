/*
  ==============================================================
  environment.config
  ==============================================================

  This file defines the ENVIRONMENT-DEPENDENT settings for
  running your annotation workflow in Nextflow. You can freely
  edit it to match your system's paths, CPU limits,
  memory allocations, or cluster queue names.

  ----------------------------------------------------------------
  WHAT GOES HERE:
   - HPC resource directives (cpus, memory, queue, executor).
   - Paths to references, such as a FASTA file or a tool's cache
     directory.
   - Possibly container images (e.g., Docker/Singularity) if you
     run on a cluster or in the cloud.

  HOW IT'S USED:
   - vcfstash passes this file alongside the locked annotation config:

       nextflow run main.nf \
         -c annotation.config \
         -c environment.config

     The two configs get merged, so your environment settings
     override or supplement the locked annotation logic.

  You can maintain multiple environment configs (e.g.,
  "environment_local.config" for your laptop,
  "environment_slurm.config" for HPC, etc.). Just pass the
  one you need each time.
*/

def VCFSTASH_ROOT = System.getenv('VCFSTASH_ROOT')

params {

    /*
      ------------------------------------------------------------
      Reference data and tool paths:
      ------------------------------------------------------------

      These are environment-specific paths that your
      annotation_cmd references. For instance, if your
      annotation_cmd uses:
        ${params.vep_cache}
        ${params.ref_fasta}
      ...define them here.

      The current example mentions VCF just to illustrate.
      vcfstash supports any workflow that modifies VCF INFO tags.
    */
    vep_cache = '/home/j380r/references/ensembl-vcf/113/cachedir'
    ref_dir = "${VCFSTASH_ROOT}/tests/data/references"
    ref_fasta = "${ref_dir}/reference.fasta"

    bcftools_cmd = "${VCFSTASH_ROOT}/tools/bcftools"
	bcftools_cmd_version = '1.20'
	bcftools_sort_memory = '4G'

	annotation_tool_cmd = "vep"
    tool_version_command = "${params.annotation_tool_cmd} --version"
    tool_version_regex   = '^ensembl-vep version (\\S+)'

    // Resource files
    chr_add = "${VCFSTASH_ROOT}/resources/chr_add.txt"

    /*
      If you run containers, you could define or override
      the container here:
        container = 'ensemblorg/ensembl-vcf:latest'

      Then in your main.nf, a process block could do:
        container = params.container
    */
     container = 'ensemblorg/ensembl-vcf:release_113.0'

    /*
      ------------------------------------------------------------
      Additional environment parameters:
      ------------------------------------------------------------

      For instance, a temporary directory
    */
    temp_dir = '/tmp'
}


process {
    /*
      ------------------------------------------------------------
      HPC / local resource settings
      ------------------------------------------------------------

      Nextflow uses "process.cpus" and "process.memory" to
      schedule resources. Adjust them as needed for your environment
      or cluster.

      Examples:
        cpus = 8
        memory = '16 GB'
    */
    cpus = 4
    memory = '8 GB'
    scratch = true

    withName: 'RenameAndNormalizeVCF' {
        memory = '4 GB'
    }

    withName: 'VEPAnnotate' {
        memory = '6 GB'
    }


    /*
      ------------------------------------------------------------
      executor:

      The Nextflow "executor" is how jobs get submitted. Common
      executors are:
        'local'  (run on your local machine)
        'slurm'  (submit to SLURM cluster)
        'pbs'    (PBS cluster)
        'k8s'    (Kubernetes)
        'nxfcloud' (various cloud setups)

      If you run locally, set:
        executor = 'local'

      For HPC with SLURM, for example:
        executor = 'slurm'
    */
    executor = 'local'
}